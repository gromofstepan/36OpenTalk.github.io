<!DOCTYPE html>
<html>
<head>
    <title>36OpenTalk</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="theme-toggle">
        <button onclick="toggleTheme()">Переключить тему</button>
    </div>

    <div class="container">
        <h1>36OpenTalk</h1>
        <textarea id="messageText" rows="5" cols="50" placeholder="Введите ваше сообщение"></textarea><br>
        <input type="file" id="imageFile" accept="image/*"><br>  <!-- Добавлено поле выбора файла -->
        <button onclick="sendMessage()">Отправить</button>
        <button onclick="window.open('https://t.me/rodnaya36', '_blank')">Перейти в Telegram</button>
        <div id="message"></div>

        <div class="contact-info">
            <h3>Gromof</h3>
            <p>https://t.me/StepanGromof</p>
            <p>©Громов Степан 2024-2025</p>
        </div>
    </div>

    <script>
        const BOT_TOKEN = "8077294714:AAFtQ5NjN-PHvvn9tDRE4vHRk-RtmISWKFk";
        const CHANNEL_ID = "@rodnaya36"; // Замените на ваш ID канала!
        //const TELEGRAM_API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;  Удалите эту строку

        async function sendMessage() {
            const messageText = document.getElementById("messageText").value;
            const imageFile = document.getElementById("imageFile").files[0]; // Получаем выбранный файл
            const messageDiv = document.getElementById("message");

            if (!messageText && !imageFile) {
                messageDiv.className = "error";
                messageDiv.textContent = "Пожалуйста, введите сообщение или выберите изображение.";
                return;
            }

            const formData = new FormData();  // Создаем объект FormData для отправки файлов

            if (messageText) {
                formData.append("caption", messageText); // Добавляем текст сообщения
            }
            if (imageFile) {
                formData.append("photo", imageFile); // Добавляем файл изображения
            }
            formData.append("chat_id", CHANNEL_ID); // Добавляем ID чата
            // Отправка изображения и текста.  Используется 'sendPhoto'
            try {
                const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                    method: "POST",
                    body: formData,
                });

                if (response.ok) {
                    messageDiv.className = "success";
                    messageDiv.textContent = "Сообщение и изображение успешно отправлены!";
                } else {
                    messageDiv.className = "error";
                    messageDiv.textContent = "Ошибка при отправке: " + response.statusText;
                }

            } catch (error) {
                messageDiv.className = "error";
                messageDiv.textContent = "Ошибка запроса: " + error;
            }
        }

        function toggleTheme() {
            const body = document.querySelector("body");
            body.classList.toggle("dark-theme");
        }
    </script>
</body>
</html>